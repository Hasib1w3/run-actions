name: Keep Spaces Alive

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

jobs:
  health_check:
    runs-on: ubuntu-latest
    steps:
      - name: GET /health for all spaces
        env:
          TOKEN_GFVBF_P305IP: ${{ secrets.HF_TOKEN_GFVBF_P305IP }}
          TOKEN_GFVBF_2QR0X2: ${{ secrets.HF_TOKEN_GFVBF_2QR0X2 }}
          TOKEN_GFVBF_OFUMX4: ${{ secrets.HF_TOKEN_GFVBF_OFUMX4 }}
          TOKEN_GFVBF_BH6I6A: ${{ secrets.HF_TOKEN_GFVBF_BH6I6A }}
          TOKEN_GFVBF_M1GDZE: ${{ secrets.HF_TOKEN_GFVBF_M1GDZE }}
          TOKEN_GNBG_9EZAK8: ${{ secrets.HF_TOKEN_GNBG_9EZAK8 }}
          TOKEN_GNBG_C4URD3: ${{ secrets.HF_TOKEN_GNBG_C4URD3 }}
          TOKEN_GNBG_OMW01F: ${{ secrets.HF_TOKEN_GNBG_OMW01F }}
          TOKEN_GNBG_UGN8QZ: ${{ secrets.HF_TOKEN_GNBG_UGN8QZ }}
          TOKEN_GNBG_C7EGV0: ${{ secrets.HF_TOKEN_GNBG_C7EGV0 }}
          TOKEN_J6GEP5ZD_H2AQBF: ${{ secrets.HF_TOKEN_J6GEP5ZD_H2AQBF }}
          TOKEN_J6GEP5ZD_T5RMKG: ${{ secrets.HF_TOKEN_J6GEP5ZD_T5RMKG }}
          TOKEN_J6GEP5ZD_NKG491: ${{ secrets.HF_TOKEN_J6GEP5ZD_NKG491 }}
          TOKEN_J6GEP5ZD_ECS2UM: ${{ secrets.HF_TOKEN_J6GEP5ZD_ECS2UM }}
          TOKEN_J6GEP5ZD_BY1TQ4: ${{ secrets.HF_TOKEN_J6GEP5ZD_BY1TQ4 }}
          TOKEN_MFLRJ8FO_XLDI3O: ${{ secrets.HF_TOKEN_MFLRJ8FO_XLDI3O }}
          TOKEN_MFLRJ8FO_IL4957: ${{ secrets.HF_TOKEN_MFLRJ8FO_IL4957 }}
          TOKEN_MFLRJ8FO_AVQ2OR: ${{ secrets.HF_TOKEN_MFLRJ8FO_AVQ2OR }}
          TOKEN_MFLRJ8FO_EL3K48: ${{ secrets.HF_TOKEN_MFLRJ8FO_EL3K48 }}
          TOKEN_MFLRJ8FO_PGCMDL: ${{ secrets.HF_TOKEN_MFLRJ8FO_PGCMDL }}
          TOKEN_84Q1HGYE_A64YOK: ${{ secrets.HF_TOKEN_84Q1HGYE_A64YOK }}
          TOKEN_84Q1HGYE_JIYHMB: ${{ secrets.HF_TOKEN_84Q1HGYE_JIYHMB }}
          TOKEN_84Q1HGYE_MPKYNV: ${{ secrets.HF_TOKEN_84Q1HGYE_MPKYNV }}
          TOKEN_84Q1HGYE_YWATPL: ${{ secrets.HF_TOKEN_84Q1HGYE_YWATPL }}
          TOKEN_84Q1HGYE_UBRIPQ: ${{ secrets.HF_TOKEN_84Q1HGYE_UBRIPQ }}
          TOKEN_BWX2LINR_Q7X5F5: ${{ secrets.HF_TOKEN_BWX2LINR_Q7X5F5 }}
          TOKEN_BWX2LINR_MLFC40: ${{ secrets.HF_TOKEN_BWX2LINR_MLFC40 }}
          TOKEN_BWX2LINR_T2KA2Q: ${{ secrets.HF_TOKEN_BWX2LINR_T2KA2Q }}
          TOKEN_BWX2LINR_6E9CKN: ${{ secrets.HF_TOKEN_BWX2LINR_6E9CKN }}
          TOKEN_BWX2LINR_VFJN4I: ${{ secrets.HF_TOKEN_BWX2LINR_VFJN4I }}
          TOKEN_36MWOJIK_XZ0UZA: ${{ secrets.HF_TOKEN_36MWOJIK_XZ0UZA }}
          TOKEN_36MWOJIK_5YKX2R: ${{ secrets.HF_TOKEN_36MWOJIK_5YKX2R }}
          TOKEN_36MWOJIK_1I15N2: ${{ secrets.HF_TOKEN_36MWOJIK_1I15N2 }}
          TOKEN_36MWOJIK_QUB3F2: ${{ secrets.HF_TOKEN_36MWOJIK_QUB3F2 }}
          TOKEN_36MWOJIK_E2P6AA: ${{ secrets.HF_TOKEN_36MWOJIK_E2P6AA }}
          TOKEN_1CYZTRKJ_KIYB1T: ${{ secrets.HF_TOKEN_1CYZTRKJ_KIYB1T }}
          TOKEN_1CYZTRKJ_TA0IF4: ${{ secrets.HF_TOKEN_1CYZTRKJ_TA0IF4 }}
          TOKEN_1CYZTRKJ_EXPTA8: ${{ secrets.HF_TOKEN_1CYZTRKJ_EXPTA8 }}
          TOKEN_1CYZTRKJ_RAP3A5: ${{ secrets.HF_TOKEN_1CYZTRKJ_RAP3A5 }}
          TOKEN_1CYZTRKJ_3ZBBLX: ${{ secrets.HF_TOKEN_1CYZTRKJ_3ZBBLX }}
          TOKEN_GPB77DWS_32IUE4: ${{ secrets.HF_TOKEN_GPB77DWS_32IUE4 }}
          TOKEN_GPB77DWS_AOXGH2: ${{ secrets.HF_TOKEN_GPB77DWS_AOXGH2 }}
          TOKEN_GPB77DWS_EHW6WF: ${{ secrets.HF_TOKEN_GPB77DWS_EHW6WF }}
          TOKEN_GPB77DWS_Z3M5W4: ${{ secrets.HF_TOKEN_GPB77DWS_Z3M5W4 }}
          TOKEN_GPB77DWS_RMUHP3: ${{ secrets.HF_TOKEN_GPB77DWS_RMUHP3 }}
          TOKEN_RPFCG5XN_GPK8RM: ${{ secrets.HF_TOKEN_RPFCG5XN_GPK8RM }}
          TOKEN_RPFCG5XN_7IFNKO: ${{ secrets.HF_TOKEN_RPFCG5XN_7IFNKO }}
          TOKEN_RPFCG5XN_5Y0H8G: ${{ secrets.HF_TOKEN_RPFCG5XN_5Y0H8G }}
          TOKEN_RPFCG5XN_8AUXM5: ${{ secrets.HF_TOKEN_RPFCG5XN_8AUXM5 }}
          TOKEN_RPFCG5XN_CN3M9B: ${{ secrets.HF_TOKEN_RPFCG5XN_CN3M9B }}
          TOKEN_VD2EYQEV_FYFR3I: ${{ secrets.HF_TOKEN_VD2EYQEV_FYFR3I }}
          TOKEN_VD2EYQEV_UK1US0: ${{ secrets.HF_TOKEN_VD2EYQEV_UK1US0 }}
          TOKEN_VD2EYQEV_6NND8M: ${{ secrets.HF_TOKEN_VD2EYQEV_6NND8M }}
          TOKEN_VD2EYQEV_LRY7BM: ${{ secrets.HF_TOKEN_VD2EYQEV_LRY7BM }}
          TOKEN_VD2EYQEV_ABRXHD: ${{ secrets.HF_TOKEN_VD2EYQEV_ABRXHD }}
          TOKEN_HASIBXX2X_7PZU02: ${{ secrets.HF_TOKEN_HASIBXX2X_7PZU02 }}
          TOKEN_HASIBXX2X_V3QCS0: ${{ secrets.HF_TOKEN_HASIBXX2X_V3QCS0 }}
          TOKEN_HASIBXX2X_HCOIKU: ${{ secrets.HF_TOKEN_HASIBXX2X_HCOIKU }}
          TOKEN_HASIBXX2X_BJU8GV: ${{ secrets.HF_TOKEN_HASIBXX2X_BJU8GV }}
          TOKEN_HASIBXX2X_KSNNRH: ${{ secrets.HF_TOKEN_HASIBXX2X_KSNNRH }}
          TOKEN_BDFBEFBH_CHVA4P: ${{ secrets.HF_TOKEN_BDFBEFBH_CHVA4P }}
          TOKEN_BDFBEFBH_JDHCCE: ${{ secrets.HF_TOKEN_BDFBEFBH_JDHCCE }}
          TOKEN_BDFBEFBH_QLJDQF: ${{ secrets.HF_TOKEN_BDFBEFBH_QLJDQF }}
          TOKEN_BDFBEFBH_8DX6Y0: ${{ secrets.HF_TOKEN_BDFBEFBH_8DX6Y0 }}
          TOKEN_BDFBEFBH_JPU6GC: ${{ secrets.HF_TOKEN_BDFBEFBH_JPU6GC }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_VO0NJ8: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_VO0NJ8 }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_MHN0EP: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_MHN0EP }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_FK54I0: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_FK54I0 }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_HEEVFP: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_HEEVFP }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_LOC5T3: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_LOC5T3 }}
          TOKEN_HTYJY6_DJK14K: ${{ secrets.HF_TOKEN_HTYJY6_DJK14K }}
          TOKEN_HTYJY6_6ZZ4D1: ${{ secrets.HF_TOKEN_HTYJY6_6ZZ4D1 }}
          TOKEN_HTYJY6_855FL3: ${{ secrets.HF_TOKEN_HTYJY6_855FL3 }}
          TOKEN_HTYJY6_WGOP7O: ${{ secrets.HF_TOKEN_HTYJY6_WGOP7O }}
          TOKEN_HTYJY6_VJUBT8: ${{ secrets.HF_TOKEN_HTYJY6_VJUBT8 }}
        run: |
          # Create temp directory for results
          RESULTS_DIR=$(mktemp -d)
          TOTAL=75
          
          echo "========================================"
          echo "üöÄ Starting GET /health checks"
          echo "   Total endpoints: $TOTAL"
          echo "   Parallel: 5 at a time"
          echo "========================================"
          echo ""

          check_url() {
            local url="$1"
            local token="$2"
            local idx="$3"
            local result_file="$RESULTS_DIR/$idx.txt"
            
            if [ -n "$token" ]; then
              code=$(curl -s -o /dev/null -w "%{http_code}" -m 60 -H "Authorization: Bearer $token" "$url" 2>/dev/null || echo "000")
            else
              code=$(curl -s -o /dev/null -w "%{http_code}" -m 60 "$url" 2>/dev/null || echo "000")
            fi
            
            if [ "$code" = "200" ]; then
              echo "‚úÖ [200] $url" >> "$result_file"
            elif [ "$code" = "000" ]; then
              echo "‚è±Ô∏è  [TIMEOUT] $url" >> "$result_file"
            elif [ "$code" = "401" ] || [ "$code" = "403" ]; then
              echo "üîê [$code] $url" >> "$result_file"
            elif [ "$code" = "404" ]; then
              echo "üîç [404] $url (not found)" >> "$result_file"
            elif [ "$code" = "502" ] || [ "$code" = "503" ]; then
              echo "üò¥ [$code] $url (sleeping/starting)" >> "$result_file"
            else
              echo "‚ùå [$code] $url" >> "$result_file"
            fi
          }
          
          export -f check_url
          export RESULTS_DIR

          check_url "https://gfvbf-p305ip.hf.space/health" "$TOKEN_GFVBF_P305IP" 0 &
          check_url "https://gfvbf-2qr0x2.hf.space/health" "$TOKEN_GFVBF_2QR0X2" 1 &
          check_url "https://gfvbf-ofumx4.hf.space/health" "$TOKEN_GFVBF_OFUMX4" 2 &
          check_url "https://gfvbf-bh6i6a.hf.space/health" "$TOKEN_GFVBF_BH6I6A" 3 &
          check_url "https://gfvbf-m1gdze.hf.space/health" "$TOKEN_GFVBF_M1GDZE" 4 &
          wait
          check_url "https://gnbg-9ezak8.hf.space/health" "$TOKEN_GNBG_9EZAK8" 5 &
          check_url "https://gnbg-c4urd3.hf.space/health" "$TOKEN_GNBG_C4URD3" 6 &
          check_url "https://gnbg-omw01f.hf.space/health" "$TOKEN_GNBG_OMW01F" 7 &
          check_url "https://gnbg-ugn8qz.hf.space/health" "$TOKEN_GNBG_UGN8QZ" 8 &
          check_url "https://gnbg-c7egv0.hf.space/health" "$TOKEN_GNBG_C7EGV0" 9 &
          wait
          check_url "https://j6gep5zd-h2aqbf.hf.space/health" "$TOKEN_J6GEP5ZD_H2AQBF" 10 &
          check_url "https://j6gep5zd-t5rmkg.hf.space/health" "$TOKEN_J6GEP5ZD_T5RMKG" 11 &
          check_url "https://j6gep5zd-nkg491.hf.space/health" "$TOKEN_J6GEP5ZD_NKG491" 12 &
          check_url "https://j6gep5zd-ecs2um.hf.space/health" "$TOKEN_J6GEP5ZD_ECS2UM" 13 &
          check_url "https://j6gep5zd-by1tq4.hf.space/health" "$TOKEN_J6GEP5ZD_BY1TQ4" 14 &
          wait
          check_url "https://mflrj8fo-xldi3o.hf.space/health" "$TOKEN_MFLRJ8FO_XLDI3O" 15 &
          check_url "https://mflrj8fo-il4957.hf.space/health" "$TOKEN_MFLRJ8FO_IL4957" 16 &
          check_url "https://mflrj8fo-avq2or.hf.space/health" "$TOKEN_MFLRJ8FO_AVQ2OR" 17 &
          check_url "https://mflrj8fo-el3k48.hf.space/health" "$TOKEN_MFLRJ8FO_EL3K48" 18 &
          check_url "https://mflrj8fo-pgcmdl.hf.space/health" "$TOKEN_MFLRJ8FO_PGCMDL" 19 &
          wait
          check_url "https://84q1hgye-a64yok.hf.space/health" "$TOKEN_84Q1HGYE_A64YOK" 20 &
          check_url "https://84q1hgye-jiyhmb.hf.space/health" "$TOKEN_84Q1HGYE_JIYHMB" 21 &
          check_url "https://84q1hgye-mpkynv.hf.space/health" "$TOKEN_84Q1HGYE_MPKYNV" 22 &
          check_url "https://84q1hgye-ywatpl.hf.space/health" "$TOKEN_84Q1HGYE_YWATPL" 23 &
          check_url "https://84q1hgye-ubripq.hf.space/health" "$TOKEN_84Q1HGYE_UBRIPQ" 24 &
          wait
          check_url "https://bwx2linr-q7x5f5.hf.space/health" "$TOKEN_BWX2LINR_Q7X5F5" 25 &
          check_url "https://bwx2linr-mlfc40.hf.space/health" "$TOKEN_BWX2LINR_MLFC40" 26 &
          check_url "https://bwx2linr-t2ka2q.hf.space/health" "$TOKEN_BWX2LINR_T2KA2Q" 27 &
          check_url "https://bwx2linr-6e9ckn.hf.space/health" "$TOKEN_BWX2LINR_6E9CKN" 28 &
          check_url "https://bwx2linr-vfjn4i.hf.space/health" "$TOKEN_BWX2LINR_VFJN4I" 29 &
          wait
          check_url "https://36mwojik-xz0uza.hf.space/health" "$TOKEN_36MWOJIK_XZ0UZA" 30 &
          check_url "https://36mwojik-5ykx2r.hf.space/health" "$TOKEN_36MWOJIK_5YKX2R" 31 &
          check_url "https://36mwojik-1i15n2.hf.space/health" "$TOKEN_36MWOJIK_1I15N2" 32 &
          check_url "https://36mwojik-qub3f2.hf.space/health" "$TOKEN_36MWOJIK_QUB3F2" 33 &
          check_url "https://36mwojik-e2p6aa.hf.space/health" "$TOKEN_36MWOJIK_E2P6AA" 34 &
          wait
          check_url "https://1cyztrkj-kiyb1t.hf.space/health" "$TOKEN_1CYZTRKJ_KIYB1T" 35 &
          check_url "https://1cyztrkj-ta0if4.hf.space/health" "$TOKEN_1CYZTRKJ_TA0IF4" 36 &
          check_url "https://1cyztrkj-expta8.hf.space/health" "$TOKEN_1CYZTRKJ_EXPTA8" 37 &
          check_url "https://1cyztrkj-rap3a5.hf.space/health" "$TOKEN_1CYZTRKJ_RAP3A5" 38 &
          check_url "https://1cyztrkj-3zbblx.hf.space/health" "$TOKEN_1CYZTRKJ_3ZBBLX" 39 &
          wait
          check_url "https://gpb77dws-32iue4.hf.space/health" "$TOKEN_GPB77DWS_32IUE4" 40 &
          check_url "https://gpb77dws-aoxgh2.hf.space/health" "$TOKEN_GPB77DWS_AOXGH2" 41 &
          check_url "https://gpb77dws-ehw6wf.hf.space/health" "$TOKEN_GPB77DWS_EHW6WF" 42 &
          check_url "https://gpb77dws-z3m5w4.hf.space/health" "$TOKEN_GPB77DWS_Z3M5W4" 43 &
          check_url "https://gpb77dws-rmuhp3.hf.space/health" "$TOKEN_GPB77DWS_RMUHP3" 44 &
          wait
          check_url "https://rpfcg5xn-gpk8rm.hf.space/health" "$TOKEN_RPFCG5XN_GPK8RM" 45 &
          check_url "https://rpfcg5xn-7ifnko.hf.space/health" "$TOKEN_RPFCG5XN_7IFNKO" 46 &
          check_url "https://rpfcg5xn-5y0h8g.hf.space/health" "$TOKEN_RPFCG5XN_5Y0H8G" 47 &
          check_url "https://rpfcg5xn-8auxm5.hf.space/health" "$TOKEN_RPFCG5XN_8AUXM5" 48 &
          check_url "https://rpfcg5xn-cn3m9b.hf.space/health" "$TOKEN_RPFCG5XN_CN3M9B" 49 &
          wait
          check_url "https://vd2eyqev-fyfr3i.hf.space/health" "$TOKEN_VD2EYQEV_FYFR3I" 50 &
          check_url "https://vd2eyqev-uk1us0.hf.space/health" "$TOKEN_VD2EYQEV_UK1US0" 51 &
          check_url "https://vd2eyqev-6nnd8m.hf.space/health" "$TOKEN_VD2EYQEV_6NND8M" 52 &
          check_url "https://vd2eyqev-lry7bm.hf.space/health" "$TOKEN_VD2EYQEV_LRY7BM" 53 &
          check_url "https://vd2eyqev-abrxhd.hf.space/health" "$TOKEN_VD2EYQEV_ABRXHD" 54 &
          wait
          check_url "https://hasibxx2x-7pzu02.hf.space/health" "$TOKEN_HASIBXX2X_7PZU02" 55 &
          check_url "https://hasibxx2x-v3qcs0.hf.space/health" "$TOKEN_HASIBXX2X_V3QCS0" 56 &
          check_url "https://hasibxx2x-hcoiku.hf.space/health" "$TOKEN_HASIBXX2X_HCOIKU" 57 &
          check_url "https://hasibxx2x-bju8gv.hf.space/health" "$TOKEN_HASIBXX2X_BJU8GV" 58 &
          check_url "https://hasibxx2x-ksnnrh.hf.space/health" "$TOKEN_HASIBXX2X_KSNNRH" 59 &
          wait
          check_url "https://bdfbefbh-chva4p.hf.space/health" "$TOKEN_BDFBEFBH_CHVA4P" 60 &
          check_url "https://bdfbefbh-jdhcce.hf.space/health" "$TOKEN_BDFBEFBH_JDHCCE" 61 &
          check_url "https://bdfbefbh-qljdqf.hf.space/health" "$TOKEN_BDFBEFBH_QLJDQF" 62 &
          check_url "https://bdfbefbh-8dx6y0.hf.space/health" "$TOKEN_BDFBEFBH_8DX6Y0" 63 &
          check_url "https://bdfbefbh-jpu6gc.hf.space/health" "$TOKEN_BDFBEFBH_JPU6GC" 64 &
          wait
          check_url "https://muhammadshahalamsheikh-vo0nj8.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_VO0NJ8" 65 &
          check_url "https://muhammadshahalamsheikh-mhn0ep.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_MHN0EP" 66 &
          check_url "https://muhammadshahalamsheikh-fk54i0.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_FK54I0" 67 &
          check_url "https://muhammadshahalamsheikh-heevfp.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_HEEVFP" 68 &
          check_url "https://muhammadshahalamsheikh-loc5t3.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_LOC5T3" 69 &
          wait
          check_url "https://htyjy6-djk14k.hf.space/health" "$TOKEN_HTYJY6_DJK14K" 70 &
          check_url "https://htyjy6-6zz4d1.hf.space/health" "$TOKEN_HTYJY6_6ZZ4D1" 71 &
          check_url "https://htyjy6-855fl3.hf.space/health" "$TOKEN_HTYJY6_855FL3" 72 &
          check_url "https://htyjy6-wgop7o.hf.space/health" "$TOKEN_HTYJY6_WGOP7O" 73 &
          check_url "https://htyjy6-vjubt8.hf.space/health" "$TOKEN_HTYJY6_VJUBT8" 74 &
          wait

          echo ""
          echo "========================================"
          echo "üìä RESULTS:"
          echo "========================================"
          
          # Print all results in order
          for i in $(seq 0 $(($TOTAL - 1))); do
            if [ -f "$RESULTS_DIR/$i.txt" ]; then
              cat "$RESULTS_DIR/$i.txt"
            else
              echo "‚ö†Ô∏è  [NO RESULT] Check $i failed"
            fi
          done
          
          # Count results
          SUCCESS=$(grep -l "‚úÖ" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          FAILED=$(grep -l "‚ùå" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          TIMEOUT=$(grep -l "‚è±Ô∏è" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          NOTFOUND=$(grep -l "üîç" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          SLEEPING=$(grep -l "üò¥" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          
          echo ""
          echo "========================================"
          echo "üìà SUMMARY:"
          echo "   ‚úÖ Success:  $SUCCESS"
          echo "   üò¥ Sleeping: $SLEEPING"
          echo "   üîç Not Found: $NOTFOUND"
          echo "   ‚è±Ô∏è  Timeout:  $TIMEOUT"
          echo "   ‚ùå Failed:   $FAILED"
          echo "   üìä Total:    $TOTAL"
          echo "========================================"
          
          # Cleanup
          rm -rf "$RESULTS_DIR"
          
          echo "‚ú® All health checks complete!"
