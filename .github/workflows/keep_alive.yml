name: Keep Spaces Alive

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

jobs:
  health_check:
    runs-on: ubuntu-latest
    steps:
      - name: GET /health for all spaces
        env:
          TOKEN_GFVBF_PXEW3Z: ${{ secrets.HF_TOKEN_GFVBF_PXEW3Z }}
          TOKEN_GFVBF_8X38CN: ${{ secrets.HF_TOKEN_GFVBF_8X38CN }}
          TOKEN_GFVBF_62N757: ${{ secrets.HF_TOKEN_GFVBF_62N757 }}
          TOKEN_GFVBF_P0AD5I: ${{ secrets.HF_TOKEN_GFVBF_P0AD5I }}
          TOKEN_GFVBF_O48HZF: ${{ secrets.HF_TOKEN_GFVBF_O48HZF }}
          TOKEN_GNBG_LRQGGS: ${{ secrets.HF_TOKEN_GNBG_LRQGGS }}
          TOKEN_GNBG_J6YOF1: ${{ secrets.HF_TOKEN_GNBG_J6YOF1 }}
          TOKEN_GNBG_O2MZ6R: ${{ secrets.HF_TOKEN_GNBG_O2MZ6R }}
          TOKEN_GNBG_U7ZD9G: ${{ secrets.HF_TOKEN_GNBG_U7ZD9G }}
          TOKEN_GNBG_14E5K7: ${{ secrets.HF_TOKEN_GNBG_14E5K7 }}
          TOKEN_J6GEP5ZD_O93SIT: ${{ secrets.HF_TOKEN_J6GEP5ZD_O93SIT }}
          TOKEN_J6GEP5ZD_E92NDH: ${{ secrets.HF_TOKEN_J6GEP5ZD_E92NDH }}
          TOKEN_J6GEP5ZD_NO055X: ${{ secrets.HF_TOKEN_J6GEP5ZD_NO055X }}
          TOKEN_J6GEP5ZD_IS90CI: ${{ secrets.HF_TOKEN_J6GEP5ZD_IS90CI }}
          TOKEN_J6GEP5ZD_5ERQ3J: ${{ secrets.HF_TOKEN_J6GEP5ZD_5ERQ3J }}
          TOKEN_MFLRJ8FO_ASKZSW: ${{ secrets.HF_TOKEN_MFLRJ8FO_ASKZSW }}
          TOKEN_MFLRJ8FO_EI08JM: ${{ secrets.HF_TOKEN_MFLRJ8FO_EI08JM }}
          TOKEN_MFLRJ8FO_UYDPXQ: ${{ secrets.HF_TOKEN_MFLRJ8FO_UYDPXQ }}
          TOKEN_MFLRJ8FO_S6TUSU: ${{ secrets.HF_TOKEN_MFLRJ8FO_S6TUSU }}
          TOKEN_MFLRJ8FO_Z20KLA: ${{ secrets.HF_TOKEN_MFLRJ8FO_Z20KLA }}
          TOKEN_84Q1HGYE_V3M4O8: ${{ secrets.HF_TOKEN_84Q1HGYE_V3M4O8 }}
          TOKEN_84Q1HGYE_CE5AAO: ${{ secrets.HF_TOKEN_84Q1HGYE_CE5AAO }}
          TOKEN_84Q1HGYE_IGSNSP: ${{ secrets.HF_TOKEN_84Q1HGYE_IGSNSP }}
          TOKEN_84Q1HGYE_SOXAAQ: ${{ secrets.HF_TOKEN_84Q1HGYE_SOXAAQ }}
          TOKEN_84Q1HGYE_83G5OU: ${{ secrets.HF_TOKEN_84Q1HGYE_83G5OU }}
          TOKEN_BWX2LINR_HVXBM2: ${{ secrets.HF_TOKEN_BWX2LINR_HVXBM2 }}
          TOKEN_BWX2LINR_AVU0MS: ${{ secrets.HF_TOKEN_BWX2LINR_AVU0MS }}
          TOKEN_BWX2LINR_Y0W0EL: ${{ secrets.HF_TOKEN_BWX2LINR_Y0W0EL }}
          TOKEN_BWX2LINR_97T9OX: ${{ secrets.HF_TOKEN_BWX2LINR_97T9OX }}
          TOKEN_BWX2LINR_GT71E0: ${{ secrets.HF_TOKEN_BWX2LINR_GT71E0 }}
          TOKEN_36MWOJIK_JAO5ZM: ${{ secrets.HF_TOKEN_36MWOJIK_JAO5ZM }}
          TOKEN_36MWOJIK_NRNTT9: ${{ secrets.HF_TOKEN_36MWOJIK_NRNTT9 }}
          TOKEN_36MWOJIK_GMVVR5: ${{ secrets.HF_TOKEN_36MWOJIK_GMVVR5 }}
          TOKEN_36MWOJIK_14DSYR: ${{ secrets.HF_TOKEN_36MWOJIK_14DSYR }}
          TOKEN_36MWOJIK_LE8Z3O: ${{ secrets.HF_TOKEN_36MWOJIK_LE8Z3O }}
          TOKEN_1CYZTRKJ_LFE6AD: ${{ secrets.HF_TOKEN_1CYZTRKJ_LFE6AD }}
          TOKEN_1CYZTRKJ_50I15G: ${{ secrets.HF_TOKEN_1CYZTRKJ_50I15G }}
          TOKEN_1CYZTRKJ_0W9Y8R: ${{ secrets.HF_TOKEN_1CYZTRKJ_0W9Y8R }}
          TOKEN_1CYZTRKJ_GJ2S6O: ${{ secrets.HF_TOKEN_1CYZTRKJ_GJ2S6O }}
          TOKEN_1CYZTRKJ_6WXUSJ: ${{ secrets.HF_TOKEN_1CYZTRKJ_6WXUSJ }}
          TOKEN_GPB77DWS_WWE4PA: ${{ secrets.HF_TOKEN_GPB77DWS_WWE4PA }}
          TOKEN_GPB77DWS_B25DRS: ${{ secrets.HF_TOKEN_GPB77DWS_B25DRS }}
          TOKEN_GPB77DWS_F16N7M: ${{ secrets.HF_TOKEN_GPB77DWS_F16N7M }}
          TOKEN_GPB77DWS_DDKJCE: ${{ secrets.HF_TOKEN_GPB77DWS_DDKJCE }}
          TOKEN_GPB77DWS_IY0BK7: ${{ secrets.HF_TOKEN_GPB77DWS_IY0BK7 }}
          TOKEN_RPFCG5XN_90P1HB: ${{ secrets.HF_TOKEN_RPFCG5XN_90P1HB }}
          TOKEN_RPFCG5XN_DSV4PL: ${{ secrets.HF_TOKEN_RPFCG5XN_DSV4PL }}
          TOKEN_RPFCG5XN_T8BEJD: ${{ secrets.HF_TOKEN_RPFCG5XN_T8BEJD }}
          TOKEN_RPFCG5XN_B7U6QY: ${{ secrets.HF_TOKEN_RPFCG5XN_B7U6QY }}
          TOKEN_RPFCG5XN_OAJZTE: ${{ secrets.HF_TOKEN_RPFCG5XN_OAJZTE }}
          TOKEN_VD2EYQEV_MX10DT: ${{ secrets.HF_TOKEN_VD2EYQEV_MX10DT }}
          TOKEN_VD2EYQEV_ZJ6DWM: ${{ secrets.HF_TOKEN_VD2EYQEV_ZJ6DWM }}
          TOKEN_VD2EYQEV_SQLLUM: ${{ secrets.HF_TOKEN_VD2EYQEV_SQLLUM }}
          TOKEN_VD2EYQEV_A8OAGI: ${{ secrets.HF_TOKEN_VD2EYQEV_A8OAGI }}
          TOKEN_VD2EYQEV_YH4E2P: ${{ secrets.HF_TOKEN_VD2EYQEV_YH4E2P }}
          TOKEN_HASIBXX2X_6Q401W: ${{ secrets.HF_TOKEN_HASIBXX2X_6Q401W }}
          TOKEN_HASIBXX2X_6CI7OM: ${{ secrets.HF_TOKEN_HASIBXX2X_6CI7OM }}
          TOKEN_HASIBXX2X_CCD3VM: ${{ secrets.HF_TOKEN_HASIBXX2X_CCD3VM }}
          TOKEN_HASIBXX2X_Z3F3I1: ${{ secrets.HF_TOKEN_HASIBXX2X_Z3F3I1 }}
          TOKEN_HASIBXX2X_XWI3BM: ${{ secrets.HF_TOKEN_HASIBXX2X_XWI3BM }}
          TOKEN_BDFBEFBH_9CWOLE: ${{ secrets.HF_TOKEN_BDFBEFBH_9CWOLE }}
          TOKEN_BDFBEFBH_KAIA86: ${{ secrets.HF_TOKEN_BDFBEFBH_KAIA86 }}
          TOKEN_BDFBEFBH_CQ66LO: ${{ secrets.HF_TOKEN_BDFBEFBH_CQ66LO }}
          TOKEN_BDFBEFBH_Q0SB78: ${{ secrets.HF_TOKEN_BDFBEFBH_Q0SB78 }}
          TOKEN_BDFBEFBH_2F2DS2: ${{ secrets.HF_TOKEN_BDFBEFBH_2F2DS2 }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_V4Q1A2: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_V4Q1A2 }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_KSV1O4: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_KSV1O4 }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_2RWAOT: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_2RWAOT }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_DYL966: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_DYL966 }}
          TOKEN_MUHAMMADSHAHALAMSHEIKH_L12J62: ${{ secrets.HF_TOKEN_MUHAMMADSHAHALAMSHEIKH_L12J62 }}
          TOKEN_HTYJY6_MS654Y: ${{ secrets.HF_TOKEN_HTYJY6_MS654Y }}
          TOKEN_HTYJY6_ATCBQH: ${{ secrets.HF_TOKEN_HTYJY6_ATCBQH }}
          TOKEN_HTYJY6_98R96B: ${{ secrets.HF_TOKEN_HTYJY6_98R96B }}
          TOKEN_HTYJY6_9CX97W: ${{ secrets.HF_TOKEN_HTYJY6_9CX97W }}
          TOKEN_HTYJY6_XDC5UC: ${{ secrets.HF_TOKEN_HTYJY6_XDC5UC }}
        run: |
          # Create temp directory for results
          RESULTS_DIR=$(mktemp -d)
          TOTAL=75
          
          echo "========================================"
          echo "üöÄ Starting GET /health checks"
          echo "   Total endpoints: $TOTAL"
          echo "   Parallel: 5 at a time"
          echo "========================================"
          echo ""

          check_url() {
            local url="$1"
            local token="$2"
            local idx="$3"
            local result_file="$RESULTS_DIR/$idx.txt"
            
            if [ -n "$token" ]; then
              code=$(curl -s -o /dev/null -w "%{http_code}" -m 60 -H "Authorization: Bearer $token" "$url" 2>/dev/null || echo "000")
            else
              code=$(curl -s -o /dev/null -w "%{http_code}" -m 60 "$url" 2>/dev/null || echo "000")
            fi
            
            if [ "$code" = "200" ]; then
              echo "‚úÖ [200] $url" >> "$result_file"
            elif [ "$code" = "000" ]; then
              echo "‚è±Ô∏è  [TIMEOUT] $url" >> "$result_file"
            elif [ "$code" = "401" ] || [ "$code" = "403" ]; then
              echo "üîê [$code] $url" >> "$result_file"
            elif [ "$code" = "404" ]; then
              echo "üîç [404] $url (not found)" >> "$result_file"
            elif [ "$code" = "502" ] || [ "$code" = "503" ]; then
              echo "üò¥ [$code] $url (sleeping/starting)" >> "$result_file"
            else
              echo "‚ùå [$code] $url" >> "$result_file"
            fi
          }
          
          export -f check_url
          export RESULTS_DIR

          check_url "https://gfvbf-pxew3z.hf.space/health" "$TOKEN_GFVBF_PXEW3Z" 0 &
          check_url "https://gfvbf-8x38cn.hf.space/health" "$TOKEN_GFVBF_8X38CN" 1 &
          check_url "https://gfvbf-62n757.hf.space/health" "$TOKEN_GFVBF_62N757" 2 &
          check_url "https://gfvbf-p0ad5i.hf.space/health" "$TOKEN_GFVBF_P0AD5I" 3 &
          check_url "https://gfvbf-o48hzf.hf.space/health" "$TOKEN_GFVBF_O48HZF" 4 &
          wait
          check_url "https://gnbg-lrqggs.hf.space/health" "$TOKEN_GNBG_LRQGGS" 5 &
          check_url "https://gnbg-j6yof1.hf.space/health" "$TOKEN_GNBG_J6YOF1" 6 &
          check_url "https://gnbg-o2mz6r.hf.space/health" "$TOKEN_GNBG_O2MZ6R" 7 &
          check_url "https://gnbg-u7zd9g.hf.space/health" "$TOKEN_GNBG_U7ZD9G" 8 &
          check_url "https://gnbg-14e5k7.hf.space/health" "$TOKEN_GNBG_14E5K7" 9 &
          wait
          check_url "https://j6gep5zd-o93sit.hf.space/health" "$TOKEN_J6GEP5ZD_O93SIT" 10 &
          check_url "https://j6gep5zd-e92ndh.hf.space/health" "$TOKEN_J6GEP5ZD_E92NDH" 11 &
          check_url "https://j6gep5zd-no055x.hf.space/health" "$TOKEN_J6GEP5ZD_NO055X" 12 &
          check_url "https://j6gep5zd-is90ci.hf.space/health" "$TOKEN_J6GEP5ZD_IS90CI" 13 &
          check_url "https://j6gep5zd-5erq3j.hf.space/health" "$TOKEN_J6GEP5ZD_5ERQ3J" 14 &
          wait
          check_url "https://mflrj8fo-askzsw.hf.space/health" "$TOKEN_MFLRJ8FO_ASKZSW" 15 &
          check_url "https://mflrj8fo-ei08jm.hf.space/health" "$TOKEN_MFLRJ8FO_EI08JM" 16 &
          check_url "https://mflrj8fo-uydpxq.hf.space/health" "$TOKEN_MFLRJ8FO_UYDPXQ" 17 &
          check_url "https://mflrj8fo-s6tusu.hf.space/health" "$TOKEN_MFLRJ8FO_S6TUSU" 18 &
          check_url "https://mflrj8fo-z20kla.hf.space/health" "$TOKEN_MFLRJ8FO_Z20KLA" 19 &
          wait
          check_url "https://84q1hgye-v3m4o8.hf.space/health" "$TOKEN_84Q1HGYE_V3M4O8" 20 &
          check_url "https://84q1hgye-ce5aao.hf.space/health" "$TOKEN_84Q1HGYE_CE5AAO" 21 &
          check_url "https://84q1hgye-igsnsp.hf.space/health" "$TOKEN_84Q1HGYE_IGSNSP" 22 &
          check_url "https://84q1hgye-soxaaq.hf.space/health" "$TOKEN_84Q1HGYE_SOXAAQ" 23 &
          check_url "https://84q1hgye-83g5ou.hf.space/health" "$TOKEN_84Q1HGYE_83G5OU" 24 &
          wait
          check_url "https://bwx2linr-hvxbm2.hf.space/health" "$TOKEN_BWX2LINR_HVXBM2" 25 &
          check_url "https://bwx2linr-avu0ms.hf.space/health" "$TOKEN_BWX2LINR_AVU0MS" 26 &
          check_url "https://bwx2linr-y0w0el.hf.space/health" "$TOKEN_BWX2LINR_Y0W0EL" 27 &
          check_url "https://bwx2linr-97t9ox.hf.space/health" "$TOKEN_BWX2LINR_97T9OX" 28 &
          check_url "https://bwx2linr-gt71e0.hf.space/health" "$TOKEN_BWX2LINR_GT71E0" 29 &
          wait
          check_url "https://36mwojik-jao5zm.hf.space/health" "$TOKEN_36MWOJIK_JAO5ZM" 30 &
          check_url "https://36mwojik-nrntt9.hf.space/health" "$TOKEN_36MWOJIK_NRNTT9" 31 &
          check_url "https://36mwojik-gmvvr5.hf.space/health" "$TOKEN_36MWOJIK_GMVVR5" 32 &
          check_url "https://36mwojik-14dsyr.hf.space/health" "$TOKEN_36MWOJIK_14DSYR" 33 &
          check_url "https://36mwojik-le8z3o.hf.space/health" "$TOKEN_36MWOJIK_LE8Z3O" 34 &
          wait
          check_url "https://1cyztrkj-lfe6ad.hf.space/health" "$TOKEN_1CYZTRKJ_LFE6AD" 35 &
          check_url "https://1cyztrkj-50i15g.hf.space/health" "$TOKEN_1CYZTRKJ_50I15G" 36 &
          check_url "https://1cyztrkj-0w9y8r.hf.space/health" "$TOKEN_1CYZTRKJ_0W9Y8R" 37 &
          check_url "https://1cyztrkj-gj2s6o.hf.space/health" "$TOKEN_1CYZTRKJ_GJ2S6O" 38 &
          check_url "https://1cyztrkj-6wxusj.hf.space/health" "$TOKEN_1CYZTRKJ_6WXUSJ" 39 &
          wait
          check_url "https://gpb77dws-wwe4pa.hf.space/health" "$TOKEN_GPB77DWS_WWE4PA" 40 &
          check_url "https://gpb77dws-b25drs.hf.space/health" "$TOKEN_GPB77DWS_B25DRS" 41 &
          check_url "https://gpb77dws-f16n7m.hf.space/health" "$TOKEN_GPB77DWS_F16N7M" 42 &
          check_url "https://gpb77dws-ddkjce.hf.space/health" "$TOKEN_GPB77DWS_DDKJCE" 43 &
          check_url "https://gpb77dws-iy0bk7.hf.space/health" "$TOKEN_GPB77DWS_IY0BK7" 44 &
          wait
          check_url "https://rpfcg5xn-90p1hb.hf.space/health" "$TOKEN_RPFCG5XN_90P1HB" 45 &
          check_url "https://rpfcg5xn-dsv4pl.hf.space/health" "$TOKEN_RPFCG5XN_DSV4PL" 46 &
          check_url "https://rpfcg5xn-t8bejd.hf.space/health" "$TOKEN_RPFCG5XN_T8BEJD" 47 &
          check_url "https://rpfcg5xn-b7u6qy.hf.space/health" "$TOKEN_RPFCG5XN_B7U6QY" 48 &
          check_url "https://rpfcg5xn-oajzte.hf.space/health" "$TOKEN_RPFCG5XN_OAJZTE" 49 &
          wait
          check_url "https://vd2eyqev-mx10dt.hf.space/health" "$TOKEN_VD2EYQEV_MX10DT" 50 &
          check_url "https://vd2eyqev-zj6dwm.hf.space/health" "$TOKEN_VD2EYQEV_ZJ6DWM" 51 &
          check_url "https://vd2eyqev-sqllum.hf.space/health" "$TOKEN_VD2EYQEV_SQLLUM" 52 &
          check_url "https://vd2eyqev-a8oagi.hf.space/health" "$TOKEN_VD2EYQEV_A8OAGI" 53 &
          check_url "https://vd2eyqev-yh4e2p.hf.space/health" "$TOKEN_VD2EYQEV_YH4E2P" 54 &
          wait
          check_url "https://hasibxx2x-6q401w.hf.space/health" "$TOKEN_HASIBXX2X_6Q401W" 55 &
          check_url "https://hasibxx2x-6ci7om.hf.space/health" "$TOKEN_HASIBXX2X_6CI7OM" 56 &
          check_url "https://hasibxx2x-ccd3vm.hf.space/health" "$TOKEN_HASIBXX2X_CCD3VM" 57 &
          check_url "https://hasibxx2x-z3f3i1.hf.space/health" "$TOKEN_HASIBXX2X_Z3F3I1" 58 &
          check_url "https://hasibxx2x-xwi3bm.hf.space/health" "$TOKEN_HASIBXX2X_XWI3BM" 59 &
          wait
          check_url "https://bdfbefbh-9cwole.hf.space/health" "$TOKEN_BDFBEFBH_9CWOLE" 60 &
          check_url "https://bdfbefbh-kaia86.hf.space/health" "$TOKEN_BDFBEFBH_KAIA86" 61 &
          check_url "https://bdfbefbh-cq66lo.hf.space/health" "$TOKEN_BDFBEFBH_CQ66LO" 62 &
          check_url "https://bdfbefbh-q0sb78.hf.space/health" "$TOKEN_BDFBEFBH_Q0SB78" 63 &
          check_url "https://bdfbefbh-2f2ds2.hf.space/health" "$TOKEN_BDFBEFBH_2F2DS2" 64 &
          wait
          check_url "https://muhammadshahalamsheikh-v4q1a2.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_V4Q1A2" 65 &
          check_url "https://muhammadshahalamsheikh-ksv1o4.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_KSV1O4" 66 &
          check_url "https://muhammadshahalamsheikh-2rwaot.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_2RWAOT" 67 &
          check_url "https://muhammadshahalamsheikh-dyl966.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_DYL966" 68 &
          check_url "https://muhammadshahalamsheikh-l12j62.hf.space/health" "$TOKEN_MUHAMMADSHAHALAMSHEIKH_L12J62" 69 &
          wait
          check_url "https://htyjy6-ms654y.hf.space/health" "$TOKEN_HTYJY6_MS654Y" 70 &
          check_url "https://htyjy6-atcbqh.hf.space/health" "$TOKEN_HTYJY6_ATCBQH" 71 &
          check_url "https://htyjy6-98r96b.hf.space/health" "$TOKEN_HTYJY6_98R96B" 72 &
          check_url "https://htyjy6-9cx97w.hf.space/health" "$TOKEN_HTYJY6_9CX97W" 73 &
          check_url "https://htyjy6-xdc5uc.hf.space/health" "$TOKEN_HTYJY6_XDC5UC" 74 &
          wait

          echo ""
          echo "========================================"
          echo "üìä RESULTS:"
          echo "========================================"
          
          # Print all results in order
          for i in $(seq 0 $(($TOTAL - 1))); do
            if [ -f "$RESULTS_DIR/$i.txt" ]; then
              cat "$RESULTS_DIR/$i.txt"
            else
              echo "‚ö†Ô∏è  [NO RESULT] Check $i failed"
            fi
          done
          
          # Count results
          SUCCESS=$(grep -l "‚úÖ" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          FAILED=$(grep -l "‚ùå" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          TIMEOUT=$(grep -l "‚è±Ô∏è" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          NOTFOUND=$(grep -l "üîç" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          SLEEPING=$(grep -l "üò¥" $RESULTS_DIR/*.txt 2>/dev/null | wc -l)
          
          echo ""
          echo "========================================"
          echo "üìà SUMMARY:"
          echo "   ‚úÖ Success:  $SUCCESS"
          echo "   üò¥ Sleeping: $SLEEPING"
          echo "   üîç Not Found: $NOTFOUND"
          echo "   ‚è±Ô∏è  Timeout:  $TIMEOUT"
          echo "   ‚ùå Failed:   $FAILED"
          echo "   üìä Total:    $TOTAL"
          echo "========================================"
          
          # Cleanup
          rm -rf "$RESULTS_DIR"
          
          echo "‚ú® All health checks complete!"
